"use strict";!function i(u,c,s){function a(t,e){if(!c[t]){if(!u[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(f)return f(t,!0);var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}var o=c[t]={exports:{}};u[t][0].call(o.exports,function(e){return a(u[t][1][e]||e)},o,o.exports,i,u,c,s)}return c[t].exports}for(var f="function"==typeof require&&require,e=0;e<s.length;e++)a(s[e]);return a}({1:[function(e,d,t){!function(){function u(n){return new Promise(function(e,t){n.onsuccess=function(){e(n.result)},n.onerror=function(){t(n.error)}})}function i(n,r,o){var i,e=new Promise(function(e,t){u(i=n[r].apply(n,o)).then(e,t)});return e.request=i,e}function e(e,n,t){t.forEach(function(t){Object.defineProperty(e.prototype,t,{get:function(){return this[n][t]},set:function(e){this[n][t]=e}})})}function t(t,n,r,e){e.forEach(function(e){e in r.prototype&&(t.prototype[e]=function(){return i(this[n],e,arguments)})})}function n(t,n,r,e){e.forEach(function(e){e in r.prototype&&(t.prototype[e]=function(){return this[n][e].apply(this[n],arguments)})})}function r(e,r,t,n){n.forEach(function(n){n in t.prototype&&(e.prototype[n]=function(){return e=this[r],(t=i(e,n,arguments)).then(function(e){if(e)return new c(e,t.request)});var e,t})})}function o(e){this._index=e}function c(e,t){this._cursor=e,this._request=t}function s(e){this._store=e}function a(n){this._tx=n,this.complete=new Promise(function(e,t){n.oncomplete=function(){e()},n.onerror=function(){t(n.error)},n.onabort=function(){t(n.error)}})}function f(e,t,n){this._db=e,this.oldVersion=t,this.transaction=new a(n)}function l(e){this._db=e}e(o,"_index",["name","keyPath","multiEntry","unique"]),t(o,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),r(o,"_index",IDBIndex,["openCursor","openKeyCursor"]),e(c,"_cursor",["direction","key","primaryKey","value"]),t(c,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(n){n in IDBCursor.prototype&&(c.prototype[n]=function(){var t=this,e=arguments;return Promise.resolve().then(function(){return t._cursor[n].apply(t._cursor,e),u(t._request).then(function(e){if(e)return new c(e,t._request)})})})}),s.prototype.createIndex=function(){return new o(this._store.createIndex.apply(this._store,arguments))},s.prototype.index=function(){return new o(this._store.index.apply(this._store,arguments))},e(s,"_store",["name","keyPath","indexNames","autoIncrement"]),t(s,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),r(s,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),n(s,"_store",IDBObjectStore,["deleteIndex"]),a.prototype.objectStore=function(){return new s(this._tx.objectStore.apply(this._tx,arguments))},e(a,"_tx",["objectStoreNames","mode"]),n(a,"_tx",IDBTransaction,["abort"]),f.prototype.createObjectStore=function(){return new s(this._db.createObjectStore.apply(this._db,arguments))},e(f,"_db",["name","version","objectStoreNames"]),n(f,"_db",IDBDatabase,["deleteObjectStore","close"]),l.prototype.transaction=function(){return new a(this._db.transaction.apply(this._db,arguments))},e(l,"_db",["name","version","objectStoreNames"]),n(l,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(i){[s,o].forEach(function(e){i in e.prototype&&(e.prototype[i.replace("open","iterate")]=function(){var e,t=(e=arguments,Array.prototype.slice.call(e)),n=t[t.length-1],r=this._store||this._index,o=r[i].apply(r,t.slice(0,-1));o.onsuccess=function(){n(o.result)}})})}),[o,s].forEach(function(e){e.prototype.getAll||(e.prototype.getAll=function(e,n){var r=this,o=[];return new Promise(function(t){r.iterateCursor(e,function(e){e?(o.push(e.value),void 0===n||o.length!=n?e.continue():t(o)):t(o)})})})});var p={open:function(e,t,n){var r=i(indexedDB,"open",[e,t]),o=r.request;return o&&(o.onupgradeneeded=function(e){n&&n(new f(o.result,e.oldVersion,o.transaction))}),r.then(function(e){return new l(e)})},delete:function(e){return i(indexedDB,"deleteDatabase",[e])}};void 0!==d?(d.exports=p,d.exports.default=d.exports):self.idb=p}()},{}],2:[function(e,t,n){t.exports=function(){var i=e("idb").open("test-db",1,function(e){switch(e.oldVersion){case 0:e.createObjectStore("currencies",{keyPath:"pair"})}});window.fetch("https://free.currencyconverterapi.com/api/v5/currencies").then(function(e){return e.json()}).then(function(e){return e.results}).then(function(e){var t=Object.values(e),n=[],r=!0,o=!1,i=void 0;try{for(var u,c=t[Symbol.iterator]();!(r=(u=c.next()).done);r=!0){var s=u.value;n.push(s.id)}}catch(e){o=!0,i=e}finally{try{!r&&c.return&&c.return()}finally{if(o)throw i}}return n}).then(function(e){for(var t=[],n=0;n<e.length-1;n++)for(var r=n+1;r<e.length;r++)t.push(e[n]+"_"+e[r]);return t}).then(function(o){for(var e=function(r){var e="https://free.currencyconverterapi.com/api/v5/convert?q="+o[r];window.fetch(e).then(function(e){return e.json()}).then(function(e){var t=e.results;t=Object.values(t)[0].val;var n={pair:o[r],value:t};return console.log(n),n}).then(function(n){i.then(function(e){var t=e.transaction("currencies","readwrite");return t.objectStore("currencies").put(n),t.complete})})},t=0;t<o.length;t++)e(t)})}},{idb:1}],3:[function(e,t,n){t.exports=function(){if(navigator.serviceWorker){navigator.serviceWorker.register("js/sw-bundle.min.js").then(function(e){navigator.serviceWorker.controller&&(e.waiting?console.log("service worker waiting"):e.installing?console.log("service worker installing"):e.addEventListener("updatefound",function(){console.log("service worker updated")}))});var e=void 0;navigator.serviceWorker.addEventListener("controllerchange",function(){e||(window.location.reload(),e=!0)})}}},{}],4:[function(e,t,n){e("./lib/idb.js");e("./lib/reg_sw.js")();var i=document.getElementById("fromSelect"),u=document.getElementById("toSelect"),c=document.getElementById("fromInput"),s=document.getElementById("toInput");function r(e){var t,n,o,r;(isNaN(c.value)||c.value<0)&&(s.value="Please enter a number greater than zero",s.style.fontSize="1rem"),""!==c.value&&(t=i.value,n=u.value,o=c.value,r="https://free.currencyconverterapi.com/api/v5/convert?q="+t+"_"+n,fetch(r)&&fetch(r).then(function(e){return e.json()}).then(function(e){var t=e.results,n=t[Object.keys(t)].val,r=o*n;r=r.toFixed(2),s.value=r}),s.style.fontSize="2rem")}function o(e){var t=e.key;8!==t&&48!==t&&""!==c.value||(s.value="")}c.addEventListener("keyup",r),c.addEventListener("keyup",o),i.addEventListener("change",r),u.addEventListener("change",r)},{"./lib/idb.js":2,"./lib/reg_sw.js":3}]},{},[4]);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9qcy9tYWluLmpzIl0sIm5hbWVzIjpbInIiLCJlIiwibiIsInQiLCJvIiwiaSIsImYiLCJjIiwicmVxdWlyZSIsInUiLCJhIiwiRXJyb3IiLCJjb2RlIiwicCIsImV4cG9ydHMiLCJjYWxsIiwibGVuZ3RoIiwiMSIsIm1vZHVsZSIsInByb21pc2lmeVJlcXVlc3QiLCJyZXF1ZXN0IiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJvbnN1Y2Nlc3MiLCJyZXN1bHQiLCJvbmVycm9yIiwiZXJyb3IiLCJwcm9taXNpZnlSZXF1ZXN0Q2FsbCIsIm9iaiIsIm1ldGhvZCIsImFyZ3MiLCJhcHBseSIsInRoZW4iLCJwcm94eVByb3BlcnRpZXMiLCJQcm94eUNsYXNzIiwidGFyZ2V0UHJvcCIsInByb3BlcnRpZXMiLCJmb3JFYWNoIiwicHJvcCIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwicHJvdG90eXBlIiwiZ2V0IiwidGhpcyIsInNldCIsInZhbCIsInByb3h5UmVxdWVzdE1ldGhvZHMiLCJDb25zdHJ1Y3RvciIsImFyZ3VtZW50cyIsInByb3h5TWV0aG9kcyIsInByb3h5Q3Vyc29yUmVxdWVzdE1ldGhvZHMiLCJ2YWx1ZSIsIkN1cnNvciIsIkluZGV4IiwiaW5kZXgiLCJfaW5kZXgiLCJjdXJzb3IiLCJfY3Vyc29yIiwiX3JlcXVlc3QiLCJPYmplY3RTdG9yZSIsInN0b3JlIiwiX3N0b3JlIiwiVHJhbnNhY3Rpb24iLCJpZGJUcmFuc2FjdGlvbiIsIl90eCIsImNvbXBsZXRlIiwib25jb21wbGV0ZSIsIm9uYWJvcnQiLCJVcGdyYWRlREIiLCJkYiIsIm9sZFZlcnNpb24iLCJ0cmFuc2FjdGlvbiIsIl9kYiIsIkRCIiwiSURCSW5kZXgiLCJJREJDdXJzb3IiLCJtZXRob2ROYW1lIiwiY3JlYXRlSW5kZXgiLCJJREJPYmplY3RTdG9yZSIsIm9iamVjdFN0b3JlIiwiSURCVHJhbnNhY3Rpb24iLCJjcmVhdGVPYmplY3RTdG9yZSIsIklEQkRhdGFiYXNlIiwiZnVuY05hbWUiLCJyZXBsYWNlIiwiYXJyIiwiQXJyYXkiLCJzbGljZSIsImNhbGxiYWNrIiwibmF0aXZlT2JqZWN0IiwiZ2V0QWxsIiwicXVlcnkiLCJjb3VudCIsImluc3RhbmNlIiwiaXRlbXMiLCJpdGVyYXRlQ3Vyc29yIiwicHVzaCIsInVuZGVmaW5lZCIsImNvbnRpbnVlIiwiZXhwIiwib3BlbiIsIm5hbWUiLCJ2ZXJzaW9uIiwidXBncmFkZUNhbGxiYWNrIiwiaW5kZXhlZERCIiwib251cGdyYWRlbmVlZGVkIiwiZXZlbnQiLCJkZWxldGUiLCJkZWZhdWx0Iiwic2VsZiIsImlkYiIsIjIiLCJkYlByb21pc2UiLCJ1cGdyYWRlRGIiLCJrZXlQYXRoIiwid2luZG93IiwiZmV0Y2giLCJyZXNwb25zZSIsImpzb24iLCJkYXRhIiwicmVzdWx0cyIsImN1cnJlbmNpZXMiLCJjdXJyZW5jaWVzQXJyYXkiLCJ2YWx1ZXMiLCJjdXJyZW5jaWVzSWRzIiwiX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiIsIl9kaWRJdGVyYXRvckVycm9yIiwiX2l0ZXJhdG9yRXJyb3IiLCJfc3RlcCIsIl9pdGVyYXRvciIsIlN5bWJvbCIsIml0ZXJhdG9yIiwibmV4dCIsImRvbmUiLCJjdXJyZW5jeSIsImlkIiwiZXJyIiwicmV0dXJuIiwicGFpcnMiLCJqIiwiX2xvb3AiLCJ1cmwiLCJyZXMiLCJ2YWxPYmoiLCJwYWlyIiwiY29uc29sZSIsImxvZyIsInR4IiwicHV0IiwiMyIsIm5hdmlnYXRvciIsInNlcnZpY2VXb3JrZXIiLCJyZWdpc3RlciIsInJlZyIsImNvbnRyb2xsZXIiLCJ3YWl0aW5nIiwiaW5zdGFsbGluZyIsImFkZEV2ZW50TGlzdGVuZXIiLCJyZWZyZXNoaW5nIiwibG9jYXRpb24iLCJyZWxvYWQiLCI0IiwiX3N3IiwiZnJvbVNlbGVjdCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJ0b1NlbGVjdCIsImZyb21JbnB1dCIsInRvSW5wdXQiLCJ1cGRhdGVPdXRwdXQiLCJmcm9tIiwidG8iLCJhbXQiLCJpc05hTiIsInN0eWxlIiwiZm9udFNpemUiLCJjb252ZXJzaW9uIiwia2V5cyIsImNvbnZlcnRlZCIsInRvRml4ZWQiLCJjbGVhck91dHB1dCIsImtleSIsIi4vbGliL2lkYi5qcyIsIi4vbGliL3JlZ19zdy5qcyJdLCJtYXBwaW5ncyI6ImNBQVksU0FBU0EsRUFBRUMsRUFBRUMsRUFBRUMsR0FBRyxTQUFTQyxFQUFFQyxFQUFFQyxHQUFHLElBQUlKLEVBQUVHLEdBQUcsQ0FBQyxJQUFJSixFQUFFSSxHQUFHLENBQUMsSUFBSUUsRUFBRSxtQkFBbUJDLFNBQVNBLFFBQVEsSUFBSUYsR0FBR0MsRUFBRSxPQUFPQSxFQUFFRixHQUFFLEdBQUksR0FBR0ksRUFBRSxPQUFPQSxFQUFFSixHQUFFLEdBQUksSUFBSUssRUFBRSxJQUFJQyxNQUFNLHVCQUF1Qk4sRUFBRSxLQUFLLE1BQU1LLEVBQUVFLEtBQUssbUJBQW1CRixFQUFFLElBQUlHLEVBQUVYLEVBQUVHLEdBQUcsQ0FBQ1MsUUFBUSxJQUFJYixFQUFFSSxHQUFHLEdBQUdVLEtBQUtGLEVBQUVDLFFBQVEsU0FBU2QsR0FBb0IsT0FBT0ksRUFBbEJILEVBQUVJLEdBQUcsR0FBR0wsSUFBZUEsSUFBSWEsRUFBRUEsRUFBRUMsUUFBUWQsRUFBRUMsRUFBRUMsRUFBRUMsR0FBRyxPQUFPRCxFQUFFRyxHQUFHUyxRQUFRLElBQUksSUFBSUwsRUFBRSxtQkFBbUJELFNBQVNBLFFBQVFILEVBQUUsRUFBRUEsRUFBRUYsRUFBRWEsT0FBT1gsSUFBSUQsRUFBRUQsRUFBRUUsSUFBSSxPQUFPRCxFQUE3YixDQUE0YyxDQUFDYSxFQUFFLENBQUMsU0FBU1QsRUFBUVUsRUFBT0osSUFHdmUsV0FLQyxTQUFTSyxFQUFpQkMsR0FDeEIsT0FBTyxJQUFJQyxRQUFRLFNBQVNDLEVBQVNDLEdBQ25DSCxFQUFRSSxVQUFZLFdBQ2xCRixFQUFRRixFQUFRSyxTQUdsQkwsRUFBUU0sUUFBVSxXQUNoQkgsRUFBT0gsRUFBUU8sVUFLckIsU0FBU0MsRUFBcUJDLEVBQUtDLEVBQVFDLEdBQ3pDLElBQUlYLEVBQ0FQLEVBQUksSUFBSVEsUUFBUSxTQUFTQyxFQUFTQyxHQUVwQ0osRUFEQUMsRUFBVVMsRUFBSUMsR0FBUUUsTUFBTUgsRUFBS0UsSUFDUEUsS0FBS1gsRUFBU0MsS0FJMUMsT0FEQVYsRUFBRU8sUUFBVUEsRUFDTFAsRUFXVCxTQUFTcUIsRUFBZ0JDLEVBQVlDLEVBQVlDLEdBQy9DQSxFQUFXQyxRQUFRLFNBQVNDLEdBQzFCQyxPQUFPQyxlQUFlTixFQUFXTyxVQUFXSCxFQUFNLENBQ2hESSxJQUFLLFdBQ0gsT0FBT0MsS0FBS1IsR0FBWUcsSUFFMUJNLElBQUssU0FBU0MsR0FDWkYsS0FBS1IsR0FBWUcsR0FBUU8sT0FNakMsU0FBU0MsRUFBb0JaLEVBQVlDLEVBQVlZLEVBQWFYLEdBQ2hFQSxFQUFXQyxRQUFRLFNBQVNDLEdBQ3BCQSxLQUFRUyxFQUFZTixZQUMxQlAsRUFBV08sVUFBVUgsR0FBUSxXQUMzQixPQUFPWCxFQUFxQmdCLEtBQUtSLEdBQWFHLEVBQU1VLGVBSzFELFNBQVNDLEVBQWFmLEVBQVlDLEVBQVlZLEVBQWFYLEdBQ3pEQSxFQUFXQyxRQUFRLFNBQVNDLEdBQ3BCQSxLQUFRUyxFQUFZTixZQUMxQlAsRUFBV08sVUFBVUgsR0FBUSxXQUMzQixPQUFPSyxLQUFLUixHQUFZRyxHQUFNUCxNQUFNWSxLQUFLUixHQUFhYSxlQUs1RCxTQUFTRSxFQUEwQmhCLEVBQVlDLEVBQVlZLEVBQWFYLEdBQ3RFQSxFQUFXQyxRQUFRLFNBQVNDLEdBQ3BCQSxLQUFRUyxFQUFZTixZQUMxQlAsRUFBV08sVUFBVUgsR0FBUSxXQUMzQixPQTNDOEJWLEVBMkNJZSxLQUFLUixJQTFDdkN2QixFQUFJZSxFQUFxQkMsRUEwQzJCVSxFQUFNVSxZQXpDckRoQixLQUFLLFNBQVNtQixHQUNyQixHQUFLQSxFQUNMLE9BQU8sSUFBSUMsRUFBT0QsRUFBT3ZDLEVBQUVPLFdBSi9CLElBQW9DUyxFQUM5QmhCLE1BK0NOLFNBQVN5QyxFQUFNQyxHQUNiWCxLQUFLWSxPQUFTRCxFQXVCaEIsU0FBU0YsRUFBT0ksRUFBUXJDLEdBQ3RCd0IsS0FBS2MsUUFBVUQsRUFDZmIsS0FBS2UsU0FBV3ZDLEVBK0JsQixTQUFTd0MsRUFBWUMsR0FDbkJqQixLQUFLa0IsT0FBU0QsRUF1Q2hCLFNBQVNFLEVBQVlDLEdBQ25CcEIsS0FBS3FCLElBQU1ELEVBQ1hwQixLQUFLc0IsU0FBVyxJQUFJN0MsUUFBUSxTQUFTQyxFQUFTQyxHQUM1Q3lDLEVBQWVHLFdBQWEsV0FDMUI3QyxLQUVGMEMsRUFBZXRDLFFBQVUsV0FDdkJILEVBQU95QyxFQUFlckMsUUFFeEJxQyxFQUFlSSxRQUFVLFdBQ3ZCN0MsRUFBT3lDLEVBQWVyQyxVQWtCNUIsU0FBUzBDLEVBQVVDLEVBQUlDLEVBQVlDLEdBQ2pDNUIsS0FBSzZCLElBQU1ILEVBQ1gxQixLQUFLMkIsV0FBYUEsRUFDbEIzQixLQUFLNEIsWUFBYyxJQUFJVCxFQUFZUyxHQWtCckMsU0FBU0UsRUFBR0osR0FDVjFCLEtBQUs2QixJQUFNSCxFQS9JYnBDLEVBQWdCb0IsRUFBTyxTQUFVLENBQy9CLE9BQ0EsVUFDQSxhQUNBLFdBR0ZQLEVBQW9CTyxFQUFPLFNBQVVxQixTQUFVLENBQzdDLE1BQ0EsU0FDQSxTQUNBLGFBQ0EsVUFHRnhCLEVBQTBCRyxFQUFPLFNBQVVxQixTQUFVLENBQ25ELGFBQ0Esa0JBUUZ6QyxFQUFnQm1CLEVBQVEsVUFBVyxDQUNqQyxZQUNBLE1BQ0EsYUFDQSxVQUdGTixFQUFvQk0sRUFBUSxVQUFXdUIsVUFBVyxDQUNoRCxTQUNBLFdBSUYsQ0FBQyxVQUFXLFdBQVksc0JBQXNCdEMsUUFBUSxTQUFTdUMsR0FDdkRBLEtBQWNELFVBQVVsQyxZQUM5QlcsRUFBT1gsVUFBVW1DLEdBQWMsV0FDN0IsSUFBSXBCLEVBQVNiLEtBQ1RiLEVBQU9rQixVQUNYLE9BQU81QixRQUFRQyxVQUFVVyxLQUFLLFdBRTVCLE9BREF3QixFQUFPQyxRQUFRbUIsR0FBWTdDLE1BQU15QixFQUFPQyxRQUFTM0IsR0FDMUNaLEVBQWlCc0MsRUFBT0UsVUFBVTFCLEtBQUssU0FBU21CLEdBQ3JELEdBQUtBLEVBQ0wsT0FBTyxJQUFJQyxFQUFPRCxFQUFPSyxFQUFPRSxrQkFVeENDLEVBQVlsQixVQUFVb0MsWUFBYyxXQUNsQyxPQUFPLElBQUl4QixFQUFNVixLQUFLa0IsT0FBT2dCLFlBQVk5QyxNQUFNWSxLQUFLa0IsT0FBUWIsYUFHOURXLEVBQVlsQixVQUFVYSxNQUFRLFdBQzVCLE9BQU8sSUFBSUQsRUFBTVYsS0FBS2tCLE9BQU9QLE1BQU12QixNQUFNWSxLQUFLa0IsT0FBUWIsYUFHeERmLEVBQWdCMEIsRUFBYSxTQUFVLENBQ3JDLE9BQ0EsVUFDQSxhQUNBLGtCQUdGYixFQUFvQmEsRUFBYSxTQUFVbUIsZUFBZ0IsQ0FDekQsTUFDQSxNQUNBLFNBQ0EsUUFDQSxNQUNBLFNBQ0EsU0FDQSxhQUNBLFVBR0Y1QixFQUEwQlMsRUFBYSxTQUFVbUIsZUFBZ0IsQ0FDL0QsYUFDQSxrQkFHRjdCLEVBQWFVLEVBQWEsU0FBVW1CLGVBQWdCLENBQ2xELGdCQWtCRmhCLEVBQVlyQixVQUFVc0MsWUFBYyxXQUNsQyxPQUFPLElBQUlwQixFQUFZaEIsS0FBS3FCLElBQUllLFlBQVloRCxNQUFNWSxLQUFLcUIsSUFBS2hCLGFBRzlEZixFQUFnQjZCLEVBQWEsTUFBTyxDQUNsQyxtQkFDQSxTQUdGYixFQUFhYSxFQUFhLE1BQU9rQixlQUFnQixDQUMvQyxVQVNGWixFQUFVM0IsVUFBVXdDLGtCQUFvQixXQUN0QyxPQUFPLElBQUl0QixFQUFZaEIsS0FBSzZCLElBQUlTLGtCQUFrQmxELE1BQU1ZLEtBQUs2QixJQUFLeEIsYUFHcEVmLEVBQWdCbUMsRUFBVyxNQUFPLENBQ2hDLE9BQ0EsVUFDQSxxQkFHRm5CLEVBQWFtQixFQUFXLE1BQU9jLFlBQWEsQ0FDMUMsb0JBQ0EsVUFPRlQsRUFBR2hDLFVBQVU4QixZQUFjLFdBQ3pCLE9BQU8sSUFBSVQsRUFBWW5CLEtBQUs2QixJQUFJRCxZQUFZeEMsTUFBTVksS0FBSzZCLElBQUt4QixhQUc5RGYsRUFBZ0J3QyxFQUFJLE1BQU8sQ0FDekIsT0FDQSxVQUNBLHFCQUdGeEIsRUFBYXdCLEVBQUksTUFBT1MsWUFBYSxDQUNuQyxVQUtGLENBQUMsYUFBYyxpQkFBaUI3QyxRQUFRLFNBQVM4QyxHQUMvQyxDQUFDeEIsRUFBYU4sR0FBT2hCLFFBQVEsU0FBU1UsR0FFOUJvQyxLQUFZcEMsRUFBWU4sWUFFOUJNLEVBQVlOLFVBQVUwQyxFQUFTQyxRQUFRLE9BQVEsWUFBYyxXQUMzRCxJQXZQV0MsRUF1UFB2RCxHQXZQT3VELEVBdVBRckMsVUF0UGhCc0MsTUFBTTdDLFVBQVU4QyxNQUFNekUsS0FBS3VFLElBdVAxQkcsRUFBVzFELEVBQUtBLEVBQUtmLE9BQVMsR0FDOUIwRSxFQUFlOUMsS0FBS2tCLFFBQVVsQixLQUFLWSxPQUNuQ3BDLEVBQVVzRSxFQUFhTixHQUFVcEQsTUFBTTBELEVBQWMzRCxFQUFLeUQsTUFBTSxHQUFJLElBQ3hFcEUsRUFBUUksVUFBWSxXQUNsQmlFLEVBQVNyRSxFQUFRSyxlQU96QixDQUFDNkIsRUFBT00sR0FBYXRCLFFBQVEsU0FBU1UsR0FDaENBLEVBQVlOLFVBQVVpRCxTQUMxQjNDLEVBQVlOLFVBQVVpRCxPQUFTLFNBQVNDLEVBQU9DLEdBQzdDLElBQUlDLEVBQVdsRCxLQUNYbUQsRUFBUSxHQUVaLE9BQU8sSUFBSTFFLFFBQVEsU0FBU0MsR0FDMUJ3RSxFQUFTRSxjQUFjSixFQUFPLFNBQVNuQyxHQUNoQ0EsR0FJTHNDLEVBQU1FLEtBQUt4QyxFQUFPTCxZQUVKOEMsSUFBVkwsR0FBdUJFLEVBQU0vRSxRQUFVNkUsRUFJM0NwQyxFQUFPMEMsV0FITDdFLEVBQVF5RSxJQU5SekUsRUFBUXlFLFdBZWxCLElBQUlLLEVBQU0sQ0FDUkMsS0FBTSxTQUFTQyxFQUFNQyxFQUFTQyxHQUM1QixJQUFJM0YsRUFBSWUsRUFBcUI2RSxVQUFXLE9BQVEsQ0FBQ0gsRUFBTUMsSUFDbkRuRixFQUFVUCxFQUFFTyxRQVVoQixPQVJJQSxJQUNGQSxFQUFRc0YsZ0JBQWtCLFNBQVNDLEdBQzdCSCxHQUNGQSxFQUFnQixJQUFJbkMsRUFBVWpELEVBQVFLLE9BQVFrRixFQUFNcEMsV0FBWW5ELEVBQVFvRCxnQkFLdkUzRCxFQUFFb0IsS0FBSyxTQUFTcUMsR0FDckIsT0FBTyxJQUFJSSxFQUFHSixNQUdsQnNDLE9BQVEsU0FBU04sR0FDZixPQUFPMUUsRUFBcUI2RSxVQUFXLGlCQUFrQixDQUFDSCxXQUl4QyxJQUFYcEYsR0FDVEEsRUFBT0osUUFBVXNGLEVBQ2pCbEYsRUFBT0osUUFBUStGLFFBQVUzRixFQUFPSixTQUdoQ2dHLEtBQUtDLElBQU1YLEVBdlRkLElBMlRDLElBQUlZLEVBQUUsQ0FBQyxTQUFTeEcsRUFBUVUsRUFBT0osR0FDakNJLEVBQU9KLFFBQVUsV0FDZixJQUVJbUcsRUFGUXpHLEVBQVEsT0FFQTZGLEtBQUssVUFBVyxFQUFHLFNBQVVhLEdBQy9DLE9BQVFBLEVBQVUzQyxZQUNoQixLQUFLLEVBQ0gyQyxFQUFVaEMsa0JBQWtCLGFBQWMsQ0FBRWlDLFFBQVMsWUFPdkRDLE9BQU9DLE1BREssMkRBRVRwRixLQUFLLFNBQUFxRixHQUFBLE9BQVlBLEVBQVNDLFNBQzFCdEYsS0FBSyxTQUFBdUYsR0FFSixPQURpQkEsRUFBS0MsVUFHdkJ4RixLQUFLLFNBQUF5RixHQUNKLElBQUlDLEVBQWtCbkYsT0FBT29GLE9BQU9GLEdBQ2hDRyxFQUFnQixHQUZGQyxHQUFBLEVBQUFDLEdBQUEsRUFBQUMsT0FBQTlCLEVBQUEsSUFHbEIsSUFBQSxJQUFBK0IsRUFBQUMsRUFBcUJQLEVBQXJCUSxPQUFBQyxjQUFBTixHQUFBRyxFQUFBQyxFQUFBRyxRQUFBQyxNQUFBUixHQUFBLEVBQXNDLENBQUEsSUFBN0JTLEVBQTZCTixFQUFBN0UsTUFDcEN5RSxFQUFjNUIsS0FBS3NDLEVBQVNDLEtBSlosTUFBQUMsR0FBQVYsR0FBQSxFQUFBQyxFQUFBUyxFQUFBLFFBQUEsS0FBQVgsR0FBQUksRUFBQVEsUUFBQVIsRUFBQVEsU0FBQSxRQUFBLEdBQUFYLEVBQUEsTUFBQUMsR0FPbEIsT0FBT0gsSUFDTjVGLEtBQUssU0FBQTRGLEdBR04sSUFGQSxJQUFJYyxFQUFRLEdBRUh0SSxFQUFJLEVBQUdBLEVBQUl3SCxFQUFjN0csT0FBUyxFQUFHWCxJQUM1QyxJQUFLLElBQUl1SSxFQUFJdkksRUFBSSxFQUFHdUksRUFBSWYsRUFBYzdHLE9BQVE0SCxJQUM1Q0QsRUFBTTFDLEtBQVE0QixFQUFjeEgsR0FBNUIsSUFBa0N3SCxFQUFjZSxJQUlwRCxPQUFPRCxJQUNOMUcsS0FBSyxTQUFBMEcsR0FDTixJQURlLElBQUFFLEVBQUEsU0FDTnhJLEdBQ1AsSUFBSXlJLEVBQUFBLDBEQUFnRUgsRUFBTXRJLEdBQzFFK0csT0FBT0MsTUFBTXlCLEdBQ1Y3RyxLQUFLLFNBQUFxRixHQUFBLE9BQVlBLEVBQVNDLFNBQzFCdEYsS0FBSyxTQUFBOEcsR0FDSixJQUFJakcsRUFBTWlHLEVBQUl0QixRQUNkM0UsRUFBTU4sT0FBT29GLE9BQU85RSxHQUFLLEdBQUdBLElBQzVCLElBQUlrRyxFQUFTLENBQ1hDLEtBQU1OLEVBQU10SSxHQUNaK0MsTUFBT04sR0FHVCxPQURBb0csUUFBUUMsSUFBSUgsR0FDTEEsSUFFUi9HLEtBQUssU0FBQStHLEdBQ0ovQixFQUFVaEYsS0FBSyxTQUFVcUMsR0FDdkIsSUFBSThFLEVBQUs5RSxFQUFHRSxZQUFZLGFBQWMsYUFHdEMsT0FGa0I0RSxFQUFHcEUsWUFBWSxjQUNyQnFFLElBQUlMLEdBQ1RJLEVBQUdsRixjQW5CVDdELEVBQUksRUFBR0EsRUFBSXNJLEVBQU0zSCxPQUFRWCxJQUFLd0ksRUFBOUJ4SSxPQThCakIsQ0FBQzBHLElBQU0sSUFBSXVDLEVBQUUsQ0FBQyxTQUFTOUksRUFBUVUsRUFBT0osR0FDeENJLEVBQU9KLFFBQVUsV0FDZixHQUFLeUksVUFBVUMsY0FBZixDQUNBRCxVQUFVQyxjQUFjQyxTQUFTLHVCQUF1QnhILEtBQUssU0FBVXlILEdBQ2hFSCxVQUFVQyxjQUFjRyxhQUl6QkQsRUFBSUUsUUFDTlYsUUFBUUMsSUFBSSwwQkFJVk8sRUFBSUcsV0FDTlgsUUFBUUMsSUFBSSw2QkFJZE8sRUFBSUksaUJBQWlCLGNBQWUsV0FDbENaLFFBQVFDLElBQUksK0JBTWhCLElBQUlZLE9BQUFBLEVBQ0pSLFVBQVVDLGNBQWNNLGlCQUFpQixtQkFBb0IsV0FDdkRDLElBQ0ozQyxPQUFPNEMsU0FBU0MsU0FDaEJGLEdBQWEsUUFJZixJQUFJRyxFQUFFLENBQUMsU0FBUzFKLEVBQVFVLEVBQU9KLEdBR3BCTixFQUFRLGdCQUdUQSxFQUFRLGtCQUNwQjJKLEdBRUEsSUFFSUMsRUFBYUMsU0FBU0MsZUFBZSxjQUNyQ0MsRUFBV0YsU0FBU0MsZUFBZSxZQUVuQ0UsRUFBWUgsU0FBU0MsZUFBZSxhQUNwQ0csRUFBVUosU0FBU0MsZUFBZSxXQUV0QyxTQUFTSSxFQUFjL0QsR0EwRHZCLElBQXVCZ0UsRUFBTUMsRUFBSUMsRUFDM0IvQixHQTFEQWdDLE1BQU1OLEVBQVVwSCxRQUFVb0gsRUFBVXBILE1BQVEsS0FDOUNxSCxFQUFRckgsTUFBUSwwQ0FDaEJxSCxFQUFRTSxNQUFNQyxTQUFXLFFBRUgsS0FBcEJSLEVBQVVwSCxRQXFET3VILEVBcEROUCxFQUFXaEgsTUFvREN3SCxFQXBETUwsRUFBU25ILE1Bb0RYeUgsRUFwRGtCTCxFQUFVcEgsTUFxRHZEMEYsRUFBQUEsMERBQWdFNkIsRUFBaEUsSUFBd0VDLEVBRXhFdkQsTUFBTXlCLElBQ1J6QixNQUFNeUIsR0FDSDdHLEtBQUssU0FBQXFGLEdBQUEsT0FBWUEsRUFBU0MsU0FDMUJ0RixLQUFLLFNBQUF1RixHQUNKLElBQUl5RCxFQUFhekQsRUFBS0MsUUFFbEJyRSxFQUFRNkgsRUFBV3pJLE9BQU8wSSxLQUFLRCxJQUFhbkksSUFFNUNxSSxFQUFZTixFQUFNekgsRUFDdEIrSCxFQUFZQSxFQUFVQyxRQUFRLEdBRTlCWCxFQUFRckgsTUFBUStILElBakVwQlYsRUFBUU0sTUFBTUMsU0FBVyxRQUk3QixTQUFTSyxFQUFhMUUsR0FDcEIsSUFBSTJFLEVBQU0zRSxFQUFNMkUsSUFDSixJQUFSQSxHQUFxQixLQUFSQSxHQUFrQyxLQUFwQmQsRUFBVXBILFFBQ3ZDcUgsRUFBUXJILE1BQVEsSUFLbEJvSCxFQUFVVixpQkFBaUIsUUFBU1ksR0FDcENGLEVBQVVWLGlCQUFpQixRQUFTdUIsR0FDcENqQixFQUFXTixpQkFBaUIsU0FBVVksR0FDdENILEVBQVNULGlCQUFpQixTQUFVWSxJQXVFcEMsQ0FBQ2EsZUFBZSxFQUFFQyxrQkFBa0IsS0FBSyxHQUFHLENBQUMiLCJmaWxlIjoianMvbWFpbi1idW5kbGUubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSh7MTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbihmdW5jdGlvbigpIHtcbiAgZnVuY3Rpb24gdG9BcnJheShhcnIpIHtcbiAgICByZXR1cm4gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJyKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHByb21pc2lmeVJlcXVlc3QocmVxdWVzdCkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgIHJlcXVlc3Qub25zdWNjZXNzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJlc29sdmUocmVxdWVzdC5yZXN1bHQpO1xuICAgICAgfTtcblxuICAgICAgcmVxdWVzdC5vbmVycm9yID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJlamVjdChyZXF1ZXN0LmVycm9yKTtcbiAgICAgIH07XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBwcm9taXNpZnlSZXF1ZXN0Q2FsbChvYmosIG1ldGhvZCwgYXJncykge1xuICAgIHZhciByZXF1ZXN0O1xuICAgIHZhciBwID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICByZXF1ZXN0ID0gb2JqW21ldGhvZF0uYXBwbHkob2JqLCBhcmdzKTtcbiAgICAgIHByb21pc2lmeVJlcXVlc3QocmVxdWVzdCkudGhlbihyZXNvbHZlLCByZWplY3QpO1xuICAgIH0pO1xuXG4gICAgcC5yZXF1ZXN0ID0gcmVxdWVzdDtcbiAgICByZXR1cm4gcDtcbiAgfVxuXG4gIGZ1bmN0aW9uIHByb21pc2lmeUN1cnNvclJlcXVlc3RDYWxsKG9iaiwgbWV0aG9kLCBhcmdzKSB7XG4gICAgdmFyIHAgPSBwcm9taXNpZnlSZXF1ZXN0Q2FsbChvYmosIG1ldGhvZCwgYXJncyk7XG4gICAgcmV0dXJuIHAudGhlbihmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgaWYgKCF2YWx1ZSkgcmV0dXJuO1xuICAgICAgcmV0dXJuIG5ldyBDdXJzb3IodmFsdWUsIHAucmVxdWVzdCk7XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBwcm94eVByb3BlcnRpZXMoUHJveHlDbGFzcywgdGFyZ2V0UHJvcCwgcHJvcGVydGllcykge1xuICAgIHByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbihwcm9wKSB7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUHJveHlDbGFzcy5wcm90b3R5cGUsIHByb3AsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gdGhpc1t0YXJnZXRQcm9wXVtwcm9wXTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbih2YWwpIHtcbiAgICAgICAgICB0aGlzW3RhcmdldFByb3BdW3Byb3BdID0gdmFsO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHByb3h5UmVxdWVzdE1ldGhvZHMoUHJveHlDbGFzcywgdGFyZ2V0UHJvcCwgQ29uc3RydWN0b3IsIHByb3BlcnRpZXMpIHtcbiAgICBwcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24ocHJvcCkge1xuICAgICAgaWYgKCEocHJvcCBpbiBDb25zdHJ1Y3Rvci5wcm90b3R5cGUpKSByZXR1cm47XG4gICAgICBQcm94eUNsYXNzLnByb3RvdHlwZVtwcm9wXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gcHJvbWlzaWZ5UmVxdWVzdENhbGwodGhpc1t0YXJnZXRQcm9wXSwgcHJvcCwgYXJndW1lbnRzKTtcbiAgICAgIH07XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBwcm94eU1ldGhvZHMoUHJveHlDbGFzcywgdGFyZ2V0UHJvcCwgQ29uc3RydWN0b3IsIHByb3BlcnRpZXMpIHtcbiAgICBwcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24ocHJvcCkge1xuICAgICAgaWYgKCEocHJvcCBpbiBDb25zdHJ1Y3Rvci5wcm90b3R5cGUpKSByZXR1cm47XG4gICAgICBQcm94eUNsYXNzLnByb3RvdHlwZVtwcm9wXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpc1t0YXJnZXRQcm9wXVtwcm9wXS5hcHBseSh0aGlzW3RhcmdldFByb3BdLCBhcmd1bWVudHMpO1xuICAgICAgfTtcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHByb3h5Q3Vyc29yUmVxdWVzdE1ldGhvZHMoUHJveHlDbGFzcywgdGFyZ2V0UHJvcCwgQ29uc3RydWN0b3IsIHByb3BlcnRpZXMpIHtcbiAgICBwcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24ocHJvcCkge1xuICAgICAgaWYgKCEocHJvcCBpbiBDb25zdHJ1Y3Rvci5wcm90b3R5cGUpKSByZXR1cm47XG4gICAgICBQcm94eUNsYXNzLnByb3RvdHlwZVtwcm9wXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gcHJvbWlzaWZ5Q3Vyc29yUmVxdWVzdENhbGwodGhpc1t0YXJnZXRQcm9wXSwgcHJvcCwgYXJndW1lbnRzKTtcbiAgICAgIH07XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBJbmRleChpbmRleCkge1xuICAgIHRoaXMuX2luZGV4ID0gaW5kZXg7XG4gIH1cblxuICBwcm94eVByb3BlcnRpZXMoSW5kZXgsICdfaW5kZXgnLCBbXG4gICAgJ25hbWUnLFxuICAgICdrZXlQYXRoJyxcbiAgICAnbXVsdGlFbnRyeScsXG4gICAgJ3VuaXF1ZSdcbiAgXSk7XG5cbiAgcHJveHlSZXF1ZXN0TWV0aG9kcyhJbmRleCwgJ19pbmRleCcsIElEQkluZGV4LCBbXG4gICAgJ2dldCcsXG4gICAgJ2dldEtleScsXG4gICAgJ2dldEFsbCcsXG4gICAgJ2dldEFsbEtleXMnLFxuICAgICdjb3VudCdcbiAgXSk7XG5cbiAgcHJveHlDdXJzb3JSZXF1ZXN0TWV0aG9kcyhJbmRleCwgJ19pbmRleCcsIElEQkluZGV4LCBbXG4gICAgJ29wZW5DdXJzb3InLFxuICAgICdvcGVuS2V5Q3Vyc29yJ1xuICBdKTtcblxuICBmdW5jdGlvbiBDdXJzb3IoY3Vyc29yLCByZXF1ZXN0KSB7XG4gICAgdGhpcy5fY3Vyc29yID0gY3Vyc29yO1xuICAgIHRoaXMuX3JlcXVlc3QgPSByZXF1ZXN0O1xuICB9XG5cbiAgcHJveHlQcm9wZXJ0aWVzKEN1cnNvciwgJ19jdXJzb3InLCBbXG4gICAgJ2RpcmVjdGlvbicsXG4gICAgJ2tleScsXG4gICAgJ3ByaW1hcnlLZXknLFxuICAgICd2YWx1ZSdcbiAgXSk7XG5cbiAgcHJveHlSZXF1ZXN0TWV0aG9kcyhDdXJzb3IsICdfY3Vyc29yJywgSURCQ3Vyc29yLCBbXG4gICAgJ3VwZGF0ZScsXG4gICAgJ2RlbGV0ZSdcbiAgXSk7XG5cbiAgLy8gcHJveHkgJ25leHQnIG1ldGhvZHNcbiAgWydhZHZhbmNlJywgJ2NvbnRpbnVlJywgJ2NvbnRpbnVlUHJpbWFyeUtleSddLmZvckVhY2goZnVuY3Rpb24obWV0aG9kTmFtZSkge1xuICAgIGlmICghKG1ldGhvZE5hbWUgaW4gSURCQ3Vyc29yLnByb3RvdHlwZSkpIHJldHVybjtcbiAgICBDdXJzb3IucHJvdG90eXBlW21ldGhvZE5hbWVdID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgY3Vyc29yID0gdGhpcztcbiAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzO1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgIGN1cnNvci5fY3Vyc29yW21ldGhvZE5hbWVdLmFwcGx5KGN1cnNvci5fY3Vyc29yLCBhcmdzKTtcbiAgICAgICAgcmV0dXJuIHByb21pc2lmeVJlcXVlc3QoY3Vyc29yLl9yZXF1ZXN0KS50aGVuKGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgICAgaWYgKCF2YWx1ZSkgcmV0dXJuO1xuICAgICAgICAgIHJldHVybiBuZXcgQ3Vyc29yKHZhbHVlLCBjdXJzb3IuX3JlcXVlc3QpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH07XG4gIH0pO1xuXG4gIGZ1bmN0aW9uIE9iamVjdFN0b3JlKHN0b3JlKSB7XG4gICAgdGhpcy5fc3RvcmUgPSBzdG9yZTtcbiAgfVxuXG4gIE9iamVjdFN0b3JlLnByb3RvdHlwZS5jcmVhdGVJbmRleCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBuZXcgSW5kZXgodGhpcy5fc3RvcmUuY3JlYXRlSW5kZXguYXBwbHkodGhpcy5fc3RvcmUsIGFyZ3VtZW50cykpO1xuICB9O1xuXG4gIE9iamVjdFN0b3JlLnByb3RvdHlwZS5pbmRleCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBuZXcgSW5kZXgodGhpcy5fc3RvcmUuaW5kZXguYXBwbHkodGhpcy5fc3RvcmUsIGFyZ3VtZW50cykpO1xuICB9O1xuXG4gIHByb3h5UHJvcGVydGllcyhPYmplY3RTdG9yZSwgJ19zdG9yZScsIFtcbiAgICAnbmFtZScsXG4gICAgJ2tleVBhdGgnLFxuICAgICdpbmRleE5hbWVzJyxcbiAgICAnYXV0b0luY3JlbWVudCdcbiAgXSk7XG5cbiAgcHJveHlSZXF1ZXN0TWV0aG9kcyhPYmplY3RTdG9yZSwgJ19zdG9yZScsIElEQk9iamVjdFN0b3JlLCBbXG4gICAgJ3B1dCcsXG4gICAgJ2FkZCcsXG4gICAgJ2RlbGV0ZScsXG4gICAgJ2NsZWFyJyxcbiAgICAnZ2V0JyxcbiAgICAnZ2V0QWxsJyxcbiAgICAnZ2V0S2V5JyxcbiAgICAnZ2V0QWxsS2V5cycsXG4gICAgJ2NvdW50J1xuICBdKTtcblxuICBwcm94eUN1cnNvclJlcXVlc3RNZXRob2RzKE9iamVjdFN0b3JlLCAnX3N0b3JlJywgSURCT2JqZWN0U3RvcmUsIFtcbiAgICAnb3BlbkN1cnNvcicsXG4gICAgJ29wZW5LZXlDdXJzb3InXG4gIF0pO1xuXG4gIHByb3h5TWV0aG9kcyhPYmplY3RTdG9yZSwgJ19zdG9yZScsIElEQk9iamVjdFN0b3JlLCBbXG4gICAgJ2RlbGV0ZUluZGV4J1xuICBdKTtcblxuICBmdW5jdGlvbiBUcmFuc2FjdGlvbihpZGJUcmFuc2FjdGlvbikge1xuICAgIHRoaXMuX3R4ID0gaWRiVHJhbnNhY3Rpb247XG4gICAgdGhpcy5jb21wbGV0ZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgaWRiVHJhbnNhY3Rpb24ub25jb21wbGV0ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXNvbHZlKCk7XG4gICAgICB9O1xuICAgICAgaWRiVHJhbnNhY3Rpb24ub25lcnJvciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZWplY3QoaWRiVHJhbnNhY3Rpb24uZXJyb3IpO1xuICAgICAgfTtcbiAgICAgIGlkYlRyYW5zYWN0aW9uLm9uYWJvcnQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmVqZWN0KGlkYlRyYW5zYWN0aW9uLmVycm9yKTtcbiAgICAgIH07XG4gICAgfSk7XG4gIH1cblxuICBUcmFuc2FjdGlvbi5wcm90b3R5cGUub2JqZWN0U3RvcmUgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gbmV3IE9iamVjdFN0b3JlKHRoaXMuX3R4Lm9iamVjdFN0b3JlLmFwcGx5KHRoaXMuX3R4LCBhcmd1bWVudHMpKTtcbiAgfTtcblxuICBwcm94eVByb3BlcnRpZXMoVHJhbnNhY3Rpb24sICdfdHgnLCBbXG4gICAgJ29iamVjdFN0b3JlTmFtZXMnLFxuICAgICdtb2RlJ1xuICBdKTtcblxuICBwcm94eU1ldGhvZHMoVHJhbnNhY3Rpb24sICdfdHgnLCBJREJUcmFuc2FjdGlvbiwgW1xuICAgICdhYm9ydCdcbiAgXSk7XG5cbiAgZnVuY3Rpb24gVXBncmFkZURCKGRiLCBvbGRWZXJzaW9uLCB0cmFuc2FjdGlvbikge1xuICAgIHRoaXMuX2RiID0gZGI7XG4gICAgdGhpcy5vbGRWZXJzaW9uID0gb2xkVmVyc2lvbjtcbiAgICB0aGlzLnRyYW5zYWN0aW9uID0gbmV3IFRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uKTtcbiAgfVxuXG4gIFVwZ3JhZGVEQi5wcm90b3R5cGUuY3JlYXRlT2JqZWN0U3RvcmUgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gbmV3IE9iamVjdFN0b3JlKHRoaXMuX2RiLmNyZWF0ZU9iamVjdFN0b3JlLmFwcGx5KHRoaXMuX2RiLCBhcmd1bWVudHMpKTtcbiAgfTtcblxuICBwcm94eVByb3BlcnRpZXMoVXBncmFkZURCLCAnX2RiJywgW1xuICAgICduYW1lJyxcbiAgICAndmVyc2lvbicsXG4gICAgJ29iamVjdFN0b3JlTmFtZXMnXG4gIF0pO1xuXG4gIHByb3h5TWV0aG9kcyhVcGdyYWRlREIsICdfZGInLCBJREJEYXRhYmFzZSwgW1xuICAgICdkZWxldGVPYmplY3RTdG9yZScsXG4gICAgJ2Nsb3NlJ1xuICBdKTtcblxuICBmdW5jdGlvbiBEQihkYikge1xuICAgIHRoaXMuX2RiID0gZGI7XG4gIH1cblxuICBEQi5wcm90b3R5cGUudHJhbnNhY3Rpb24gPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gbmV3IFRyYW5zYWN0aW9uKHRoaXMuX2RiLnRyYW5zYWN0aW9uLmFwcGx5KHRoaXMuX2RiLCBhcmd1bWVudHMpKTtcbiAgfTtcblxuICBwcm94eVByb3BlcnRpZXMoREIsICdfZGInLCBbXG4gICAgJ25hbWUnLFxuICAgICd2ZXJzaW9uJyxcbiAgICAnb2JqZWN0U3RvcmVOYW1lcydcbiAgXSk7XG5cbiAgcHJveHlNZXRob2RzKERCLCAnX2RiJywgSURCRGF0YWJhc2UsIFtcbiAgICAnY2xvc2UnXG4gIF0pO1xuXG4gIC8vIEFkZCBjdXJzb3IgaXRlcmF0b3JzXG4gIC8vIFRPRE86IHJlbW92ZSB0aGlzIG9uY2UgYnJvd3NlcnMgZG8gdGhlIHJpZ2h0IHRoaW5nIHdpdGggcHJvbWlzZXNcbiAgWydvcGVuQ3Vyc29yJywgJ29wZW5LZXlDdXJzb3InXS5mb3JFYWNoKGZ1bmN0aW9uKGZ1bmNOYW1lKSB7XG4gICAgW09iamVjdFN0b3JlLCBJbmRleF0uZm9yRWFjaChmdW5jdGlvbihDb25zdHJ1Y3Rvcikge1xuICAgICAgLy8gRG9uJ3QgY3JlYXRlIGl0ZXJhdGVLZXlDdXJzb3IgaWYgb3BlbktleUN1cnNvciBkb2Vzbid0IGV4aXN0LlxuICAgICAgaWYgKCEoZnVuY05hbWUgaW4gQ29uc3RydWN0b3IucHJvdG90eXBlKSkgcmV0dXJuO1xuXG4gICAgICBDb25zdHJ1Y3Rvci5wcm90b3R5cGVbZnVuY05hbWUucmVwbGFjZSgnb3BlbicsICdpdGVyYXRlJyldID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBhcmdzID0gdG9BcnJheShhcmd1bWVudHMpO1xuICAgICAgICB2YXIgY2FsbGJhY2sgPSBhcmdzW2FyZ3MubGVuZ3RoIC0gMV07XG4gICAgICAgIHZhciBuYXRpdmVPYmplY3QgPSB0aGlzLl9zdG9yZSB8fCB0aGlzLl9pbmRleDtcbiAgICAgICAgdmFyIHJlcXVlc3QgPSBuYXRpdmVPYmplY3RbZnVuY05hbWVdLmFwcGx5KG5hdGl2ZU9iamVjdCwgYXJncy5zbGljZSgwLCAtMSkpO1xuICAgICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGNhbGxiYWNrKHJlcXVlc3QucmVzdWx0KTtcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgfSk7XG4gIH0pO1xuXG4gIC8vIHBvbHlmaWxsIGdldEFsbFxuICBbSW5kZXgsIE9iamVjdFN0b3JlXS5mb3JFYWNoKGZ1bmN0aW9uKENvbnN0cnVjdG9yKSB7XG4gICAgaWYgKENvbnN0cnVjdG9yLnByb3RvdHlwZS5nZXRBbGwpIHJldHVybjtcbiAgICBDb25zdHJ1Y3Rvci5wcm90b3R5cGUuZ2V0QWxsID0gZnVuY3Rpb24ocXVlcnksIGNvdW50KSB7XG4gICAgICB2YXIgaW5zdGFuY2UgPSB0aGlzO1xuICAgICAgdmFyIGl0ZW1zID0gW107XG5cbiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlKSB7XG4gICAgICAgIGluc3RhbmNlLml0ZXJhdGVDdXJzb3IocXVlcnksIGZ1bmN0aW9uKGN1cnNvcikge1xuICAgICAgICAgIGlmICghY3Vyc29yKSB7XG4gICAgICAgICAgICByZXNvbHZlKGl0ZW1zKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgICAgaXRlbXMucHVzaChjdXJzb3IudmFsdWUpO1xuXG4gICAgICAgICAgaWYgKGNvdW50ICE9PSB1bmRlZmluZWQgJiYgaXRlbXMubGVuZ3RoID09IGNvdW50KSB7XG4gICAgICAgICAgICByZXNvbHZlKGl0ZW1zKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgICAgY3Vyc29yLmNvbnRpbnVlKCk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfTtcbiAgfSk7XG5cbiAgdmFyIGV4cCA9IHtcbiAgICBvcGVuOiBmdW5jdGlvbihuYW1lLCB2ZXJzaW9uLCB1cGdyYWRlQ2FsbGJhY2spIHtcbiAgICAgIHZhciBwID0gcHJvbWlzaWZ5UmVxdWVzdENhbGwoaW5kZXhlZERCLCAnb3BlbicsIFtuYW1lLCB2ZXJzaW9uXSk7XG4gICAgICB2YXIgcmVxdWVzdCA9IHAucmVxdWVzdDtcblxuICAgICAgaWYgKHJlcXVlc3QpIHtcbiAgICAgICAgcmVxdWVzdC5vbnVwZ3JhZGVuZWVkZWQgPSBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgIGlmICh1cGdyYWRlQ2FsbGJhY2spIHtcbiAgICAgICAgICAgIHVwZ3JhZGVDYWxsYmFjayhuZXcgVXBncmFkZURCKHJlcXVlc3QucmVzdWx0LCBldmVudC5vbGRWZXJzaW9uLCByZXF1ZXN0LnRyYW5zYWN0aW9uKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gcC50aGVuKGZ1bmN0aW9uKGRiKSB7XG4gICAgICAgIHJldHVybiBuZXcgREIoZGIpO1xuICAgICAgfSk7XG4gICAgfSxcbiAgICBkZWxldGU6IGZ1bmN0aW9uKG5hbWUpIHtcbiAgICAgIHJldHVybiBwcm9taXNpZnlSZXF1ZXN0Q2FsbChpbmRleGVkREIsICdkZWxldGVEYXRhYmFzZScsIFtuYW1lXSk7XG4gICAgfVxuICB9O1xuXG4gIGlmICh0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJykge1xuICAgIG1vZHVsZS5leHBvcnRzID0gZXhwO1xuICAgIG1vZHVsZS5leHBvcnRzLmRlZmF1bHQgPSBtb2R1bGUuZXhwb3J0cztcbiAgfVxuICBlbHNlIHtcbiAgICBzZWxmLmlkYiA9IGV4cDtcbiAgfVxufSgpKTtcblxufSx7fV0sMjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG5tb2R1bGUuZXhwb3J0cyA9ICgpID0+IHtcbiAgY29uc3QgaWRiID0gcmVxdWlyZSgnaWRiJylcblxuICBsZXQgZGJQcm9taXNlID0gaWRiLm9wZW4oJ3Rlc3QtZGInLCAxLCBmdW5jdGlvbiAodXBncmFkZURiKSB7XG4gICAgc3dpdGNoICh1cGdyYWRlRGIub2xkVmVyc2lvbikge1xuICAgICAgY2FzZSAwOlxuICAgICAgICB1cGdyYWRlRGIuY3JlYXRlT2JqZWN0U3RvcmUoJ2N1cnJlbmNpZXMnLCB7IGtleVBhdGg6ICdwYWlyJyB9KVxuICAgIH1cbiAgfSlcblxuICA7KGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBmZXRjaEFuZFN0b3JlQ3VycmVuY2llcyAoKSB7XG4gICAgICBjb25zdCB1cmwgPSAnaHR0cHM6Ly9mcmVlLmN1cnJlbmN5Y29udmVydGVyYXBpLmNvbS9hcGkvdjUvY3VycmVuY2llcydcbiAgICAgIHdpbmRvdy5mZXRjaCh1cmwpXG4gICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHJlc3BvbnNlLmpzb24oKSlcbiAgICAgICAgLnRoZW4oZGF0YSA9PiB7XG4gICAgICAgICAgbGV0IGN1cnJlbmNpZXMgPSBkYXRhLnJlc3VsdHNcbiAgICAgICAgICByZXR1cm4gY3VycmVuY2llc1xuICAgICAgICB9KVxuICAgICAgICAudGhlbihjdXJyZW5jaWVzID0+IHtcbiAgICAgICAgICBsZXQgY3VycmVuY2llc0FycmF5ID0gT2JqZWN0LnZhbHVlcyhjdXJyZW5jaWVzKVxuICAgICAgICAgIGxldCBjdXJyZW5jaWVzSWRzID0gW11cbiAgICAgICAgICBmb3IgKGxldCBjdXJyZW5jeSBvZiBjdXJyZW5jaWVzQXJyYXkpIHtcbiAgICAgICAgICAgIGN1cnJlbmNpZXNJZHMucHVzaChjdXJyZW5jeS5pZClcbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXR1cm4gY3VycmVuY2llc0lkc1xuICAgICAgICB9KS50aGVuKGN1cnJlbmNpZXNJZHMgPT4ge1xuICAgICAgICAgIGxldCBwYWlycyA9IFtdXG5cbiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGN1cnJlbmNpZXNJZHMubGVuZ3RoIC0gMTsgaSsrKSB7XG4gICAgICAgICAgICBmb3IgKGxldCBqID0gaSArIDE7IGogPCBjdXJyZW5jaWVzSWRzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgIHBhaXJzLnB1c2goYCR7Y3VycmVuY2llc0lkc1tpXX1fJHtjdXJyZW5jaWVzSWRzW2pdfWApXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmV0dXJuIHBhaXJzXG4gICAgICAgIH0pLnRoZW4ocGFpcnMgPT4ge1xuICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGFpcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGxldCB1cmwgPSBgaHR0cHM6Ly9mcmVlLmN1cnJlbmN5Y29udmVydGVyYXBpLmNvbS9hcGkvdjUvY29udmVydD9xPSR7cGFpcnNbaV19YFxuICAgICAgICAgICAgd2luZG93LmZldGNoKHVybClcbiAgICAgICAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gcmVzcG9uc2UuanNvbigpKVxuICAgICAgICAgICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICAgICAgICAgIGxldCB2YWwgPSByZXMucmVzdWx0c1xuICAgICAgICAgICAgICAgIHZhbCA9IE9iamVjdC52YWx1ZXModmFsKVswXS52YWxcbiAgICAgICAgICAgICAgICBsZXQgdmFsT2JqID0ge1xuICAgICAgICAgICAgICAgICAgcGFpcjogcGFpcnNbaV0sXG4gICAgICAgICAgICAgICAgICB2YWx1ZTogdmFsXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHZhbE9iailcbiAgICAgICAgICAgICAgICByZXR1cm4gdmFsT2JqXG4gICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIC50aGVuKHZhbE9iaiA9PiB7XG4gICAgICAgICAgICAgICAgZGJQcm9taXNlLnRoZW4oZnVuY3Rpb24gKGRiKSB7XG4gICAgICAgICAgICAgICAgICBsZXQgdHggPSBkYi50cmFuc2FjdGlvbignY3VycmVuY2llcycsICdyZWFkd3JpdGUnKVxuICAgICAgICAgICAgICAgICAgbGV0IGtleVZhbFN0b3JlID0gdHgub2JqZWN0U3RvcmUoJ2N1cnJlbmNpZXMnKVxuICAgICAgICAgICAgICAgICAga2V5VmFsU3RvcmUucHV0KHZhbE9iailcbiAgICAgICAgICAgICAgICAgIHJldHVybiB0eC5jb21wbGV0ZVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIH0pXG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIGZldGNoQW5kU3RvcmVDdXJyZW5jaWVzKClcbiAgfSkoKVxufVxuXG59LHtcImlkYlwiOjF9XSwzOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcbm1vZHVsZS5leHBvcnRzID0gKCkgPT4ge1xuICBpZiAoIW5hdmlnYXRvci5zZXJ2aWNlV29ya2VyKSByZXR1cm5cbiAgbmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIucmVnaXN0ZXIoJ2pzL3N3LWJ1bmRsZS5taW4uanMnKS50aGVuKGZ1bmN0aW9uIChyZWcpIHtcbiAgICBpZiAoIW5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLmNvbnRyb2xsZXIpIHtcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIGlmIChyZWcud2FpdGluZykge1xuICAgICAgY29uc29sZS5sb2coJ3NlcnZpY2Ugd29ya2VyIHdhaXRpbmcnKVxuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgaWYgKHJlZy5pbnN0YWxsaW5nKSB7XG4gICAgICBjb25zb2xlLmxvZygnc2VydmljZSB3b3JrZXIgaW5zdGFsbGluZycpXG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICByZWcuYWRkRXZlbnRMaXN0ZW5lcigndXBkYXRlZm91bmQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBjb25zb2xlLmxvZygnc2VydmljZSB3b3JrZXIgdXBkYXRlZCcpXG4gICAgfSlcbiAgfSlcblxuICAvLyBFbnN1cmUgcmVmcmVzaCBpcyBvbmx5IGNhbGxlZCBvbmNlLlxuICAvLyBUaGlzIHdvcmtzIGFyb3VuZCBhIGJ1ZyBpbiBcImZvcmNlIHVwZGF0ZSBvbiByZWxvYWRcIi5cbiAgbGV0IHJlZnJlc2hpbmdcbiAgbmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIuYWRkRXZlbnRMaXN0ZW5lcignY29udHJvbGxlcmNoYW5nZScsIGZ1bmN0aW9uICgpIHtcbiAgICBpZiAocmVmcmVzaGluZykgcmV0dXJuXG4gICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpXG4gICAgcmVmcmVzaGluZyA9IHRydWVcbiAgfSlcbn1cblxufSx7fV0sNDpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG4vKiBnbG9iYWxzIGZldGNoICovXG5cbmNvbnN0IF9pZGIgPSByZXF1aXJlKCcuL2xpYi9pZGIuanMnKVxuLy8gX2lkYigpXG5cbmNvbnN0IF9zdyA9IHJlcXVpcmUoJy4vbGliL3JlZ19zdy5qcycpXG5fc3coKVxuXG5jb25zdCB1cmwgPSAnaHR0cHM6Ly9mcmVlLmN1cnJlbmN5Y29udmVydGVyYXBpLmNvbS9hcGkvdjUvY3VycmVuY2llcydcblxubGV0IGZyb21TZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZnJvbVNlbGVjdCcpXG5sZXQgdG9TZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG9TZWxlY3QnKVxuXG5sZXQgZnJvbUlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Zyb21JbnB1dCcpXG5sZXQgdG9JbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b0lucHV0JylcblxuZnVuY3Rpb24gdXBkYXRlT3V0cHV0IChldmVudCkge1xuICBpZiAoaXNOYU4oZnJvbUlucHV0LnZhbHVlKSB8fCBmcm9tSW5wdXQudmFsdWUgPCAwKSB7XG4gICAgdG9JbnB1dC52YWx1ZSA9ICdQbGVhc2UgZW50ZXIgYSBudW1iZXIgZ3JlYXRlciB0aGFuIHplcm8nXG4gICAgdG9JbnB1dC5zdHlsZS5mb250U2l6ZSA9ICcxcmVtJ1xuICB9XG4gIGlmIChmcm9tSW5wdXQudmFsdWUgIT09ICcnKSB7XG4gICAgY29udmVydEZldGNoKGZyb21TZWxlY3QudmFsdWUsIHRvU2VsZWN0LnZhbHVlLCBmcm9tSW5wdXQudmFsdWUpXG4gICAgdG9JbnB1dC5zdHlsZS5mb250U2l6ZSA9ICcycmVtJ1xuICB9XG59XG5cbmZ1bmN0aW9uIGNsZWFyT3V0cHV0IChldmVudCkge1xuICBsZXQga2V5ID0gZXZlbnQua2V5XG4gIGlmIChrZXkgPT09IDggfHwga2V5ID09PSA0OCB8fCBmcm9tSW5wdXQudmFsdWUgPT09ICcnKSB7XG4gICAgdG9JbnB1dC52YWx1ZSA9ICcnXG4gIH1cbn1cblxuOyhmdW5jdGlvbiBldmVudHMgKCkge1xuICBmcm9tSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCB1cGRhdGVPdXRwdXQpXG4gIGZyb21JbnB1dC5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIGNsZWFyT3V0cHV0KVxuICBmcm9tU2VsZWN0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIHVwZGF0ZU91dHB1dClcbiAgdG9TZWxlY3QuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgdXBkYXRlT3V0cHV0KVxufSkoKVxuXG5mdW5jdGlvbiBmZXRjaFNlbGVjdCAoKSB7XG4gIGZldGNoKHVybClcbiAgICAudGhlbihyZXNwb25zZSA9PiByZXNwb25zZS5qc29uKCkpXG4gICAgLnRoZW4oZGF0YSA9PiB7XG4gICAgICBsZXQgY3VycmVuY2llcyA9IGRhdGEucmVzdWx0c1xuXG4gICAgICBjdXJyZW5jaWVzID0gT2JqZWN0LnZhbHVlcyhjdXJyZW5jaWVzKVxuICAgICAgY3VycmVuY2llcy5zb3J0KChhLCBiKSA9PiB7XG4gICAgICAgIGxldCB0ZXh0QSA9IGEuY3VycmVuY3lOYW1lLnRvVXBwZXJDYXNlKClcbiAgICAgICAgbGV0IHRleHRCID0gYi5jdXJyZW5jeU5hbWUudG9VcHBlckNhc2UoKVxuICAgICAgICByZXR1cm4gKHRleHRBIDwgdGV4dEIpID8gLTEgOiAodGV4dEEgPiB0ZXh0QikgPyAxIDogMFxuICAgICAgfSlcblxuICAgICAgZm9yIChsZXQgZWwgb2YgY3VycmVuY2llcykge1xuICAgICAgICBsZXQgY3VycmVuY3lOYW1lID0gZWwuY3VycmVuY3lOYW1lXG4gICAgICAgIGxldCBjdXJyZW5jeUlkID0gZWwuaWRcblxuICAgICAgICBsZXQgb3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJylcbiAgICAgICAgaWYgKGN1cnJlbmN5TmFtZS5sZW5ndGggPiAyMCkge1xuICAgICAgICAgIGN1cnJlbmN5TmFtZSA9IGAke2N1cnJlbmN5TmFtZS5zdWJzdHJpbmcoMCwgMTkpfSAuLi5gXG4gICAgICAgIH1cbiAgICAgICAgb3B0aW9uLmlubmVySFRNTCA9IGAke2N1cnJlbmN5TmFtZX0gKCR7Y3VycmVuY3lJZH0pYFxuICAgICAgICBvcHRpb24udmFsdWUgPSBjdXJyZW5jeUlkXG5cbiAgICAgICAgdmFyIG9wdGlvbkNsb25lID0gb3B0aW9uLmNsb25lTm9kZSh0cnVlKVxuXG4gICAgICAgIGZyb21TZWxlY3QuYXBwZW5kQ2hpbGQob3B0aW9uKVxuICAgICAgICB0b1NlbGVjdC5hcHBlbmRDaGlsZChvcHRpb25DbG9uZSlcbiAgICAgIH1cbiAgICB9KVxuICAgIC5jYXRjaChlcnIgPT4gY29uc29sZS5sb2coZXJyKSlcbn1cblxuZnVuY3Rpb24gY29udmVydEZldGNoIChmcm9tLCB0bywgYW10KSB7XG4gIGxldCB1cmwgPSBgaHR0cHM6Ly9mcmVlLmN1cnJlbmN5Y29udmVydGVyYXBpLmNvbS9hcGkvdjUvY29udmVydD9xPSR7ZnJvbX1fJHt0b31gXG5cbiAgaWYgKGZldGNoKHVybCkpIHtcbiAgICBmZXRjaCh1cmwpXG4gICAgICAudGhlbihyZXNwb25zZSA9PiByZXNwb25zZS5qc29uKCkpXG4gICAgICAudGhlbihkYXRhID0+IHtcbiAgICAgICAgbGV0IGNvbnZlcnNpb24gPSBkYXRhLnJlc3VsdHNcblxuICAgICAgICBsZXQgdmFsdWUgPSBjb252ZXJzaW9uW09iamVjdC5rZXlzKGNvbnZlcnNpb24pXS52YWxcblxuICAgICAgICBsZXQgY29udmVydGVkID0gYW10ICogdmFsdWVcbiAgICAgICAgY29udmVydGVkID0gY29udmVydGVkLnRvRml4ZWQoMilcblxuICAgICAgICB0b0lucHV0LnZhbHVlID0gY29udmVydGVkXG4gICAgICB9KVxuICB9IGVsc2Uge1xuICAgIC8vIGxldCBwYWlyVG9Db252ZXJ0ID0gYCR7ZnJvbX1fJHt0b31gXG5cbiAgICAvLyBkYlByb21pc2UudGhlbihmdW5jdGlvbiAoZGIpIHtcbiAgICAvLyAgIGxldCB0eCA9IGRiLnRyYW5zYWN0aW9uKCdjdXJyZW5jaWVzJywgJ3JlYWR3cml0ZScpXG4gICAgLy8gICBsZXQga2V5VmFsU3RvcmUgPSB0eC5vYmplY3RTdG9yZSgnY3VycmVuY2llcycpXG5cbiAgICAvLyAgIGxldCByZXN1bHQgPSBrZXlWYWxTdG9yZS5nZXQocGFpclRvQ29udmVydClcblxuICAgIC8vICAgbGV0IHZhbHVlID0gcmVzdWx0LnZhbHVlXG4gICAgLy8gICBsZXQgY29udmVydGVkID0gYW10ICogdmFsdWVcbiAgICAvLyAgIGNvbnZlcnRlZCA9IGNvbnZlcnRlZC50b0ZpeGVkKDIpXG5cbiAgICAvLyAgIHRvSW5wdXQudmFsdWUgPSBjb252ZXJ0ZWRcbiAgICAvLyAgIHJldHVybiB0eC5jb21wbGV0ZVxuICAgIC8vIH0pXG4gIH1cbn1cblxufSx7XCIuL2xpYi9pZGIuanNcIjoyLFwiLi9saWIvcmVnX3N3LmpzXCI6M31dfSx7fSxbNF0pO1xuIl19
